:root {
            /* --- 字型定義 (Fonts Definition) --- */
            /* 用於史詩感標題 (角色名) 和清晰的數據 (Lv, HP, 數值) */
            --font-primary: 'Cinzel', Georgia, serif;
            
            /* 用於UI介面、標題和需要高可讀性的地方 */
            --font-secondary: 'Noto Sans SC', 'Noto Sans TC', 'Microsoft YaHei', 'Microsoft JhengHei', 'PingFang SC', 'PingFang TC', Roboto, 'Helvetica Neue', Helvetica, Arial, serif, sans-serif;
            
            /* 用於背景故事等長篇內文，營造書卷氣 */
            --font-body-serif: 'Noto Serif SC', 'Noto Serif TC', 'SimSun', 'PMingLiU', 'MingLiU', 'Songti SC', 'Songti TC', Georgia, 'Times New Roman', serif, sans-serif;

            /* --- 顏色定義 (Color Definitions) --- */
            --primary-theme-color: #808080;
            --primary-theme-color-rgb: 128, 128, 128;
            --secondary-theme-color: #808080;
            --secondary-theme-color-rgb: 128, 128, 128;
            
            --tier-1-color: #57595D; --tier-1-color-rgb: 87, 89, 93;
            --tier-2-color: #50C878; --tier-2-color-rgb: 80, 200, 120;
            --tier-3-color: #2196F3; --tier-3-color-rgb: 33, 150, 243;
            --tier-4-color: #9932CC; --tier-4-color-rgb: 153, 50, 204;
            --tier-5-color: #FFD700; --tier-5-color-rgb: 255, 215, 0;
            --tier-6-color: #DC143C; --tier-6-color-rgb: 220, 20, 60;
            --tier-7-color: #00FFFF; --tier-7-color-rgb: 0, 255, 255;

            --bg-color: #1a1a1a; --card-bg-color: #2c2c2c; --border-color: #444; --text-color: #e0e0e0; --text-muted-color: #a0a0a0;
        }
        html { font-size: 16px; }
        /* 默認使用UI字體，確保整體清晰度 */
        body { font-family: var(--font-secondary); background-color: transparent; color: var(--text-color); margin: 0; padding: 20px; display: flex; justify-content: center; align-items: flex-start; min-height: 100vh; transition: padding 0.3s ease; }

        /* --- 字型應用規則 (Font Application Rules) --- */
        /* 數據與象徵性標籤使用Cinzel字體 */
        .char-level, .vital-label, .vital-value, .attribute-total {
            font-family: var(--font-primary);
        }
        /* 長篇內文使用思源宋體 */
        .story, .profile-text-block, .card-body p {
            font-family: var(--font-body-serif);
        }

        .card-wrapper { position: relative; width: 100%; max-width: 800px; z-index: 10; }
        
        .card-wrapper[data-tier="1"] { --secondary-theme-color: var(--tier-1-color); --secondary-theme-color-rgb: var(--tier-1-color-rgb); }
        .card-wrapper[data-tier="2"] { --secondary-theme-color: var(--tier-2-color); --secondary-theme-color-rgb: var(--tier-2-color-rgb); }
        .card-wrapper[data-tier="3"] { --secondary-theme-color: var(--tier-3-color); --secondary-theme-color-rgb: var(--tier-3-color-rgb); }
        .card-wrapper[data-tier="4"] { --secondary-theme-color: var(--tier-4-color); --secondary-theme-color-rgb: var(--tier-4-color-rgb); }
        .card-wrapper[data-tier="5"] { --secondary-theme-color: var(--tier-5-color); --secondary-theme-color-rgb: var(--tier-5-color-rgb); }
        .card-wrapper[data-tier="6"] { --secondary-theme-color: var(--tier-6-color); --secondary-theme-color-rgb: var(--tier-6-color-rgb); }
        .card-wrapper[data-tier="7"] { --secondary-theme-color: var(--tier-7-color); --secondary-theme-color-rgb: var(--tier-7-color-rgb); }

        .card-wrapper::before,
        .card-wrapper::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: var(--card-bg-color); border: 2px solid; border-radius: 10px; transition: transform 0.3s ease, opacity 0.3s ease; z-index: -1; }
        .card-wrapper::before { transform: rotate(-4deg); opacity: 0.8; border-color: var(--secondary-theme-color); }
        .card-wrapper::after { transform: rotate(3deg); opacity: 0.6; border-color: var(--primary-theme-color); }
        
        .character-sheet { 
            border: 3px solid var(--primary-theme-color); 
            border-radius: 10px; box-shadow: 0 0 20px rgba(0, 0, 0, 0.5); 
            overflow: hidden; position: relative; z-index: 2; width: 100%;
            background: 
                linear-gradient(to bottom, rgba(var(--secondary-theme-color-rgb), 0.3) 0%, transparent 40%), 
                radial-gradient(ellipse at 50% 100%, rgba(var(--secondary-theme-color-rgb), 0.25) 0%, transparent 70%), 
                var(--card-bg-color);
        }
        
        .character-sheet::before, .character-sheet::after { content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0; z-index: 0; opacity: 1; pointer-events:none; }
        .character-sheet::after { content: none; }

        /* --- ANIMATION STYLES START --- */

/* ========================================================================== */
/* ===              全局動態背景網格 (Global Animated Grid)               === */
/* ========================================================================== */
/* 此效果將會應用在 .character-sheet 的偽元素上，
   位於基礎漸層色之上，種族特定動畫之下 (z-index: 0)。 */

/* --- 核心修改：重新定義偽元素以承載網格 --- */
.character-sheet::before,
.character-sheet::after {
    content: '';
    position: absolute;
    inset: 0;
    z-index: 0; /* 確保在 z-index: 1 的種族動畫之下 */
    pointer-events: none;
    opacity: 0.7;
    /* 移除舊的、不必要的屬性 */
}

/* --- 第一層: 等角投影主網格 (Isometric Grid) --- */
.character-sheet::before {
    /* 使用兩組傾斜的線性漸變來創建等角網格線 */
    background-image:
        repeating-linear-gradient(
            60deg, /* 第一組線條角度 */
            rgba(var(--secondary-theme-color-rgb), 0.15) 0,
            rgba(var(--secondary-theme-color-rgb), 0.15) 1px,
            transparent 1px,
            transparent 40px /* 網格間距 */
        ),
        repeating-linear-gradient(
            120deg, /* 第二組線條角度 */
            rgba(var(--secondary-theme-color-rgb), 0.15) 0,
            rgba(var(--secondary-theme-color-rgb), 0.15) 1px,
            transparent 1px,
            transparent 40px
        );
    /* 應用一個緩慢的、對角線平移的動畫 */
    animation: grid-pan-slow 35s linear infinite;
    opacity: 0.5; /* 讓主網格更柔和 */
}

/* --- 第二層: 視差粒子點陣 (Parallax Dot Matrix) --- */
.character-sheet::after {
    /* 使用徑向漸變創建點陣圖案 */
    background-image:
        radial-gradient(
            rgba(var(--secondary-theme-color-rgb), 0.2) 1px, /* 點的大小和顏色 */
            transparent 1px
        );
    background-size: 25px 25px; /* 點陣間距 */
    /* 應用一個速度更快的平移動畫，以創造深度感 */
    animation: grid-pan-fast 20s linear infinite;
    opacity: 0.6; /* 讓粒子點更明顯一些 */
}

/* --- 動畫定義 --- */

/* 緩慢的主網格平移動畫 */
@keyframes grid-pan-slow {
    0% { background-position: 0% 0%; }
    100% { background-position: -400px -400px; }
}

/* 較快的粒子點陣平移動畫 */
@keyframes grid-pan-fast {
    0% { background-position: 0% 0%; }
    100% { background-position: 0px 500px; }
}

/* ========================================================================== */
/* ===                現代化動態背景動畫合集 (優化版)                 === */
/* ========================================================================== */

/* --- 基礎容器規則 --- */
.dynamic-bg-container {
    display: none;
    position: absolute;
    inset: 0;
    pointer-events: none;
    z-index: 1; 
}

/* === 1. 天界恩典 (Celestial Grace) === */
/* 說明：主要羽毛和光暈使用主色，閃爍的星點保留白色核心，但外圈輝光改為輔色，增強主題感。*/
.card-wrapper.bg-anim-celestial-grace .dynamic-bg-container {
    display: block;
    mix-blend-mode: screen;
    filter: brightness(1.1);
    opacity: 0.8;
}
.bg-anim-celestial-grace .particle {
    position: absolute;
    top: -15%;
    opacity: 0;
    animation-name: celestial-drift;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
    will-change: transform, opacity;
}
@keyframes celestial-drift {
    0% { transform: translateY(0) rotate(0deg); opacity: 0; }
    15% { opacity: var(--max-opacity, 0.9); }
    85% { opacity: var(--max-opacity, 0.9); }
    100% { transform: translateY(120vh) rotate(var(--spin, 0deg)); opacity: 0; }
}
.bg-anim-celestial-grace .particle:nth-child(-n+3) {
    background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 80'%3E%3Cpath fill='rgba(var(--secondary-theme-color-rgb),0.7)' d='M25,80 C50,60 50,30 25,0 C0,30 0,60 25,80Z'/%3E%3C/svg%3E");
    background-size: contain;
    background-repeat: no-repeat;
    filter: drop-shadow(0 0 8px rgba(var(--secondary-theme-color-rgb), 0.5));
}
.bg-anim-celestial-grace .particle:nth-child(n+4):nth-child(-n+7) {
    border-radius: 50%;
    background: radial-gradient(circle, rgba(var(--secondary-theme-color-rgb), 0.5), transparent 70%);
    filter: blur(20px);
}
.bg-anim-celestial-grace .particle:nth-child(n+8) {
    border-radius: 50%;
    background: #fff;
    box-shadow: 0 0 5px #fff, 0 0 10px rgba(var(--primary-theme-color-rgb), 0.6), 0 0 15px rgba(var(--secondary-theme-color-rgb), 0.5);
}
.bg-anim-celestial-grace .p1 { left: 10%; width: 40px; height: 60px; --spin: 60deg; --max-opacity: 0.8; animation-duration: 25s; animation-delay: -5s; }
.bg-anim-celestial-grace .p2 { left: 75%; width: 50px; height: 75px; --spin: -45deg; --max-opacity: 0.9; animation-duration: 20s; animation-delay: -15s; }
.bg-anim-celestial-grace .p3 { left: 40%; width: 35px; height: 50px; --spin: 80deg; --max-opacity: 0.7; animation-duration: 30s; animation-delay: -2s; }
.bg-anim-celestial-grace .p4 { left: -5%; width: 180px; height: 180px; --spin: 0deg; --max-opacity: 0.4; animation-duration: 35s; animation-delay: 0s; }
.bg-anim-celestial-grace .p5 { left: 80%; width: 150px; height: 150px; --spin: 0deg; --max-opacity: 0.5; animation-duration: 32s; animation-delay: -20s; }
.bg-anim-celestial-grace .p6 { left: 25%; width: 220px; height: 220px; --spin: 0deg; --max-opacity: 0.3; animation-duration: 40s; animation-delay: -10s; }
.bg-anim-celestial-grace .p7 { left: 50%; width: 160px; height: 160px; --spin: 0deg; --max-opacity: 0.4; animation-duration: 28s; animation-delay: -30s; }
.bg-anim-celestial-grace .p8 { left: 20%; width: 3px; height: 3px; --spin: 180deg; --max-opacity: 1; animation-duration: 12s; animation-delay: -1s; }
.bg-anim-celestial-grace .p9 { left: 90%; width: 4px; height: 4px; --spin: -120deg; --max-opacity: 1; animation-duration: 10s; animation-delay: -8s; }
.bg-anim-celestial-grace .p10 { left: 60%; width: 2px; height: 2px; --spin: 360deg; --max-opacity: 1; animation-duration: 15s; animation-delay: -4s; }
.bg-anim-celestial-grace .p11 { left: 5%; width: 3px; height: 3px; --spin: -270deg; --max-opacity: 1; animation-duration: 11s; animation-delay: -13s; }
.bg-anim-celestial-grace .p12 { left: 95%; width: 2.5px; height: 2.5px; --spin: 90deg; --max-opacity: 1; animation-duration: 13s; animation-delay: -6s; }

/* === 2. 太初源質 (Primordial Essence) === */
/* 說明：與天界恩典類似，大部分元素使用主色。閃爍星點的輝光加入輔色，使其在主色背景上更突出。*/
.card-wrapper.bg-anim-primordial-essence .dynamic-bg-container {
    display: block;
    mix-blend-mode: lighten;
    filter: brightness(1.1);
}
.bg-anim-primordial-essence .particle {
    position: absolute;
    bottom: -20%;
    opacity: 0;
    animation-name: elemental-drift;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
    will-change: transform, opacity;
}
.bg-anim-primordial-essence .particle:nth-child(-n+4) {
    border-radius: 50%;
    background: radial-gradient(circle, rgba(var(--secondary-theme-color-rgb), 0.7) 0%, transparent 80%);
    filter: blur(5px);
}
.bg-anim-primordial-essence .particle:nth-child(n+5):nth-child(-n+6) {
    background: rgba(var(--secondary-theme-color-rgb), 0.8);
    clip-path: polygon(50% 0%, 100% 35%, 85% 100%, 15% 100%, 0% 35%);
    box-shadow: 0 0 15px rgba(var(--secondary-theme-color-rgb), 0.5);
}
.bg-anim-primordial-essence .particle:nth-child(n+7):nth-child(-n+9) {
    border-radius: 45% 55% 60% 40% / 55% 45% 55% 45%;
    background: rgba(var(--secondary-theme-color-rgb), 0.5);
    filter: blur(15px);
}
.bg-anim-primordial-essence .particle:nth-child(n+10) {
    background: #fff;
    border-radius: 50%;
    box-shadow: 0 0 5px #fff, 0 0 12px rgba(var(--primary-theme-color-rgb), 0.8), 0 0 20px rgba(var(--secondary-theme-color-rgb), 0.6);
}
@keyframes elemental-drift {
    0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0; }
    10% { opacity: 0.9; }
    90% { opacity: 0.7; }
    100% { transform: translateY(-120vh) translateX(calc(var(--sway) * 50px)) rotate(calc(var(--spin) * 90deg)); opacity: 0; }
}
.bg-anim-primordial-essence .p1 { left: 10%; width: 50px; height: 50px; --sway: 1; --spin: 1; animation-duration: 22s; animation-delay: -5s; }
.bg-anim-primordial-essence .p2 { left: 75%; width: 80px; height: 80px; --sway: -1; --spin: -1.5; animation-duration: 18s; animation-delay: -2s; }
.bg-anim-primordial-essence .p3 { left: 40%; width: 30px; height: 30px; --sway: -1.2; --spin: 2; animation-duration: 28s; animation-delay: -15s; }
.bg-anim-primordial-essence .p4 { left: 90%; width: 65px; height: 65px; --sway: 0.5; --spin: -0.8; animation-duration: 16s; animation-delay: -10s; }
.bg-anim-primordial-essence .p5 { left: 25%; width: 25px; height: 40px; --sway: 1.5; --spin: 3; animation-duration: 19s; animation-delay: -7s; }
.bg-anim-primordial-essence .p6 { left: 60%; width: 35px; height: 50px; --sway: -0.8; --spin: -2.5; animation-duration: 25s; animation-delay: -18s; }
.bg-anim-primordial-essence .p7 { left: 5%; width: 120px; height: 90px; --sway: 0.3; --spin: 0.5; animation-duration: 35s; animation-delay: -1s; }
.bg-anim-primordial-essence .p8 { left: 50%; width: 150px; height: 110px; --sway: -0.5; --spin: -0.3; animation-duration: 30s; animation-delay: -20s; }
.bg-anim-primordial-essence .p9 { left: 85%; width: 100px; height: 80px; --sway: 1; --spin: 1; animation-duration: 40s; animation-delay: -25s; }
.bg-anim-primordial-essence .p10 { left: 20%; width: 3px; height: 3px; --sway: 2; --spin: 0; animation-duration: 12s; animation-delay: -4s; }
.bg-anim-primordial-essence .p11 { left: 80%; width: 4px; height: 4px; --sway: -2.5; --spin: 0; animation-duration: 10s; animation-delay: -8s; }
.bg-anim-primordial-essence .p12 { left: 55%; width: 2px; height: 2px; --sway: -1.8; --spin: 0; animation-duration: 15s; animation-delay: -13s; }

/* === 3. 輝光之心 (Radiant Heart) === */
/* 說明：核心光輝和光束使用主色。其中一個旋轉的裝飾環改用輔色來創造色彩層次。漂浮的火花和閃光也加入了輔色輝光。*/
.card-wrapper.bg-anim-radiant-heart .dynamic-bg-container {
    display: block;
    z-index: 1;
    overflow: hidden;
}
.bg-anim-radiant-heart .particle {
    position: absolute;
    opacity: 0;
    animation-iteration-count: infinite;
    will-change: transform, opacity, filter;
}
@keyframes radiant-heart-pulse {
    0%, 100% { transform: translate(-50%, -50%) scale(0.95); opacity: 0.6; filter: brightness(0.9); }
    50% { transform: translate(-50%, -50%) scale(1.05); opacity: 0.8; filter: brightness(1.1); }
}
@keyframes radiant-heart-spin {
    from { transform: rotate(0deg); } to { transform: rotate(360deg); }
}
@keyframes radiant-heart-ember-drift {
    0% { transform: translateY(0) translateX(var(--x-start, 0px)) scale(0.5); opacity: 0; }
    20% { opacity: 1; }
    100% { transform: translateY(-100vh) translateX(var(--x-end, 0px)) scale(1); opacity: 0; }
}
@keyframes radiant-heart-arc-flash {
    0%, 100% { transform: scale(0); opacity: 0; }
    50% { transform: scale(1); opacity: 1; }
}
.bg-anim-radiant-heart .p1 { top: 50%; left: 50%; width: 90vmin; height: 90vmin; background: radial-gradient(circle, rgba(var(--secondary-theme-color-rgb), 0.3) 0%, transparent 60%); border-radius: 50%; filter: blur(20px); animation-name: radiant-heart-pulse; animation-duration: 8s; animation-timing-function: ease-in-out; }
.bg-anim-radiant-heart .p2, .bg-anim-radiant-heart .p3 { top: 0; left: 0; width: 100%; height: 100%; opacity: 1; mix-blend-mode: screen; animation-name: radiant-heart-spin; animation-timing-function: linear; }
.bg-anim-radiant-heart .p2 { background: repeating-conic-gradient(from 0deg at 50% 50%, transparent 0, rgba(var(--secondary-theme-color-rgb), 0.1) 20deg, rgba(var(--secondary-theme-color-rgb), 0.05) 45deg, transparent 50deg, transparent 180deg); animation-duration: 25s; }
.bg-anim-radiant-heart .p3 { background: repeating-conic-gradient(from 90deg at 50% 50%, transparent 0, rgba(var(--secondary-theme-color-rgb), 0.15) 10deg, rgba(var(--secondary-theme-color-rgb), 0.05) 20deg, transparent 22deg, transparent 180deg); animation-duration: 20s; animation-direction: reverse; }
.bg-anim-radiant-heart .p4, .bg-anim-radiant-heart .p5 { top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 50%; background: transparent; opacity: 0.4; animation-name: radiant-heart-spin; animation-timing-function: linear; }
.bg-anim-radiant-heart .p4 { width: 70vmin; height: 70vmin; border: 2px dashed rgba(var(--secondary-theme-color-rgb), 0.8); animation-duration: 50s; }
.bg-anim-radiant-heart .p5 { width: 55vmin; height: 55vmin; border: 1px dotted rgba(var(--primary-theme-color-rgb), 0.7); animation-duration: 40s; animation-direction: reverse; }
.bg-anim-radiant-heart .particle:nth-child(n+6):nth-child(-n+9) { bottom: 0; border-radius: 50%; background: #fff; filter: brightness(1.5); box-shadow: 0 0 4px #fff, 0 0 10px rgba(var(--primary-theme-color-rgb), 0.8), 0 0 15px rgba(var(--secondary-theme-color-rgb), 1); animation-name: radiant-heart-ember-drift; animation-timing-function: ease-out; }
.bg-anim-radiant-heart .p6 { left: 15%; width: 4px; height: 4px; --x-end: -50px; animation-duration: 12s; animation-delay: -2s; }
.bg-anim-radiant-heart .p7 { left: 85%; width: 3px; height: 3px; --x-end: 60px; animation-duration: 15s; animation-delay: -8s; }
.bg-anim-radiant-heart .p8 { left: 40%; width: 5px; height: 5px; --x-end: 80px; animation-duration: 10s; animation-delay: -5s; }
.bg-anim-radiant-heart .p9 { left: 60%; width: 2.5px; height: 2.5px; --x-end: -70px; animation-duration: 18s; animation-delay: -14s; }
.bg-anim-radiant-heart .particle:nth-child(n+10) { border-radius: 50%; background: rgba(var(--secondary-theme-color-rgb), 0.9); box-shadow: 0 0 5px #fff, 0 0 10px rgba(var(--secondary-theme-color-rgb), 1); animation-name: radiant-heart-arc-flash; animation-timing-function: cubic-bezier(0.25, 1, 0.5, 1); }
.bg-anim-radiant-heart .p10 { top: 25%; left: 20%; width: 8px; height: 8px; animation-duration: 2.5s; animation-delay: -0.5s; }
.bg-anim-radiant-heart .p11 { top: 70%; left: 80%; width: 10px; height: 10px; animation-duration: 3s; animation-delay: -2s; }
.bg-anim-radiant-heart .p12 { top: 50%; left: 50%; width: 6px; height: 6px; animation-duration: 2s; animation-delay: -1.2s; }

/* === 4. 絨毛狂熱 (Fluffy Frenzy) === */
/* 說明：大部分絨毛使用主色，每第三個絨毛球改為使用輔色，並降低其透明度，製造出柔和的色彩混合效果。*/
.card-wrapper.bg-anim-fluffy-frenzy .dynamic-bg-container {
    display: block;
    filter: blur(25px) brightness(1.2);
    overflow: hidden;
}
.bg-anim-fluffy-frenzy .particle {
    position: absolute;
    opacity: 0;
    background-color: rgba(var(--secondary-theme-color-rgb), 0.6);
    border-radius: 50%;
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out;
}
.bg-anim-fluffy-frenzy .particle:nth-child(3n) {
    background-color: rgba(var(--primary-theme-color-rgb), 0.45);
}
@keyframes fluffy-float-b-to-t { 0% { transform: translateY(20vh) scale(0.7); opacity: 0; } 30%, 70% { opacity: 1; } 100% { transform: translateY(-20vh) scale(1.1); opacity: 0; } }
@keyframes fluffy-float-t-to-b { 0% { transform: translateY(-20vh) scale(0.8); opacity: 0; } 30%, 70% { opacity: 1; } 100% { transform: translateY(20vh) scale(1); opacity: 0; } }
@keyframes fluffy-float-l-to-r { 0% { transform: translateX(-20vw) rotate(-90deg) scale(0.6); opacity: 0; } 30%, 70% { opacity: 1; } 100% { transform: translateX(20vw) rotate(90deg) scale(1.2); opacity: 0; } }
@keyframes fluffy-float-r-to-l { 0% { transform: translateX(20vw) rotate(90deg) scale(0.9); opacity: 0; } 30%, 70% { opacity: 1; } 100% { transform: translateX(-20vw) rotate(-90deg) scale(1); opacity: 0; } }
.bg-anim-fluffy-frenzy .p1 { width: 25vw; height: 25vw; top: 80%; left: 10%; animation-name: fluffy-float-b-to-t; animation-duration: 15s; animation-delay: -2s; }
.bg-anim-fluffy-frenzy .p2 { width: 35vw; height: 35vw; top: 90%; left: 60%; animation-name: fluffy-float-b-to-t; animation-duration: 18s; animation-delay: -10s; }
.bg-anim-fluffy-frenzy .p3 { width: 30vw; height: 30vw; top: -10%; left: 40%; animation-name: fluffy-float-t-to-b; animation-duration: 16s; animation-delay: -5s; }
.bg-anim-fluffy-frenzy .p4 { width: 28vw; height: 28vw; top: -20%; left: 85%; animation-name: fluffy-float-t-to-b; animation-duration: 14s; animation-delay: -12s; }
.bg-anim-fluffy-frenzy .p5 { width: 40vw; height: 40vw; top: 10%; left: -20%; animation-name: fluffy-float-l-to-r; animation-duration: 20s; animation-delay: 0s; }
.bg-anim-fluffy-frenzy .p6 { width: 20vw; height: 20vw; top: 60%; left: -10%; animation-name: fluffy-float-l-to-r; animation-duration: 13s; animation-delay: -8s; }
.bg-anim-fluffy-frenzy .p7 { width: 38vw; height: 38vw; top: 40%; left: 90%; animation-name: fluffy-float-r-to-l; animation-duration: 22s; animation-delay: -3s; }
.bg-anim-fluffy-frenzy .p8 { width: 22vw; height: 22vw; top: 5%; left: 80%; animation-name: fluffy-float-r-to-l; animation-duration: 17s; animation-delay: -15s; }
.bg-anim-fluffy-frenzy .p9 { width: 22vw; height: 22vw; top: 70%; left: 35%; animation-name: fluffy-float-b-to-t; animation-duration: 19s; animation-delay: -7s; }
.bg-anim-fluffy-frenzy .p10 { width: 33vw; height: 33vw; top: 0%; left: 70%; animation-name: fluffy-float-t-to-b; animation-duration: 21s; animation-delay: -14s; }
.bg-anim-fluffy-frenzy .p11 { width: 28vw; height: 28vw; top: 30%; left: -15%; animation-name: fluffy-float-l-to-r; animation-duration: 14s; animation-delay: -4s; }
.bg-anim-fluffy-frenzy .p12 { width: 32vw; height: 32vw; top: 80%; left: 80%; animation-name: fluffy-float-r-to-l; animation-duration: 19s; animation-delay: -9s; }

/* === 5. 林地微風 (Sylvan Breeze) === */
/* 說明：原版已完美使用主色和輔色。將葉片的漸變色明確指向主色和輔色，確保與新系統完全兼容。*/
.card-wrapper.bg-anim-sylvan-breeze .dynamic-bg-container {
    display: block;
    overflow: hidden;
}
.bg-anim-sylvan-breeze .particle {
    position: absolute;
    bottom: -15%;
    opacity: 0;
    background-image: linear-gradient( to bottom, rgba(var(--secondary-theme-color-rgb), 0.9), rgba(var(--primary-theme-color-rgb), 0.5) );
    -webkit-mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 80'%3E%3Cpath fill='white' d='M25,80 C50,60 50,30 25,0 C0,30 0,60 25,80Z'/%3E%3C/svg%3E");
    mask-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 50 80'%3E%3Cpath fill='white' d='M25,80 C50,60 50,30 25,0 C0,30 0,60 25,80Z'/%3E%3C/svg%3E");
    -webkit-mask-size: contain;
    mask-size: contain;
    -webkit-mask-repeat: no-repeat;
    mask-repeat: no-repeat;
    animation-iteration-count: infinite;
    animation-timing-function: linear;
    filter: brightness(1.2);
}
@keyframes leaf-flutter { 0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0; } 10% { opacity: 1; } 100% { transform: translateY(-120vh) translateX(150px) rotate(720deg); opacity: 0; } }
@keyframes leaf-flutter-reverse { 0% { transform: translateY(0) translateX(0) rotate(0deg); opacity: 0; } 10% { opacity: 1; } 100% { transform: translateY(-120vh) translateX(-150px) rotate(-720deg); opacity: 0; } }
.bg-anim-sylvan-breeze .p1 { left: 10%; width: 40px; height: 60px; animation-name: leaf-flutter; animation-duration: 12s; animation-delay: 0s; }
.bg-anim-sylvan-breeze .p2 { left: 70%; width: 60px; height: 90px; animation-name: leaf-flutter-reverse; animation-duration: 10s; animation-delay: -5s; }
.bg-anim-sylvan-breeze .p3 { left: 40%; width: 30px; height: 45px; animation-name: leaf-flutter; animation-duration: 18s; animation-delay: -2s; }
.bg-anim-sylvan-breeze .p4 { left: 90%; width: 50px; height: 75px; animation-name: leaf-flutter; animation-duration: 11s; animation-delay: -10s; }
.bg-anim-sylvan-breeze .p5 { left: -10%; width: 45px; height: 65px; animation-name: leaf-flutter-reverse; animation-duration: 14s; animation-delay: -12s; }
.bg-anim-sylvan-breeze .p6 { left: 25%; width: 25px; height: 40px; animation-name: leaf-flutter; animation-duration: 20s; animation-delay: -7s; }
.bg-anim-sylvan-breeze .p7 { left: 30%; width: 55px; height: 80px; animation-name: leaf-flutter-reverse; animation-duration: 15s; animation-delay: -8s; }
.bg-anim-sylvan-breeze .p8 { left: 80%; width: 35px; height: 50px; animation-name: leaf-flutter; animation-duration: 13s; animation-delay: -3s; }
.bg-anim-sylvan-breeze .p9 { left: 55%; width: 65px; height: 95px; animation-name: leaf-flutter-reverse; animation-duration: 9s; animation-delay: -9s; }
.bg-anim-sylvan-breeze .p10 { left: 0%; width: 38px; height: 55px; animation-name: leaf-flutter; animation-duration: 17s; animation-delay: -15s; }
.bg-anim-sylvan-breeze .p11 { left: 85%; width: 28px; height: 42px; animation-name: leaf-flutter-reverse; animation-duration: 22s; animation-delay: -1s; }
.bg-anim-sylvan-breeze .p12 { left: 48%; width: 48px; height: 70px; animation-name: leaf-flutter; animation-duration: 16s; animation-delay: -11s; }

/* === 6. 龍鱗統御 (Dragonscale Dominion) === */
/* 說明：將鱗片的漸變光暈改為從輔色（高光）過渡到主色（主體），更好地體現雙色主題。*/
.card-wrapper.bg-anim-dragonscale-dominion .dynamic-bg-container {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    justify-items: center;
    overflow: hidden;
}
.bg-anim-dragonscale-dominion .particle:nth-child(4n - 3) { grid-column: 1; }
.bg-anim-dragonscale-dominion .particle:nth-child(4n - 2) { grid-column: 2; margin-top: 15vmin; }
.bg-anim-dragonscale-dominion .particle:nth-child(4n - 1) { grid-column: 3; }
.bg-anim-dragonscale-dominion .particle:nth-child(4n)     { grid-column: 4; margin-top: 15vmin; }
.bg-anim-dragonscale-dominion .particle {
    position: relative;
    width: 25vmin;
    height: 30vmin;
    margin-bottom: -15vmin;
    clip-path: polygon(0% 0%, 100% 0%, 100% 75%, 50% 100%, 0% 75%);
    background: radial-gradient(ellipse at 50% 100%, rgba(var(--primary-theme-color-rgb), 0.9) 0%, rgba(var(--secondary-theme-color-rgb), 0.6) 60%, transparent 80%);
    animation-name: scale-glimmer, endless-scroll-grid;
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out, linear;
}
@keyframes scale-glimmer {
    0%, 100% { opacity: 0.6; transform: scale(1); filter: brightness(0.8); }
    50% { opacity: 1; transform: scale(1.05); filter: brightness(1.2); }
}
@keyframes endless-scroll-grid {
    from { transform: translateY(-30vmin); }
    to { transform: translateY(30vmin); }
}
.bg-anim-dragonscale-dominion .p1, .p5, .p9 { animation-duration: 5s, 30s; animation-delay: -1s, 0s; }
.bg-anim-dragonscale-dominion .p2, .p6, .p10 { animation-duration: 7s, 35s; animation-delay: -3s, -5s; animation-direction: alternate, reverse; }
.bg-anim-dragonscale-dominion .p3, .p7, .p11 { animation-duration: 6s, 28s; animation-delay: -2s, -10s; }
.bg-anim-dragonscale-dominion .p4, .p8, .p12 { animation-duration: 8s, 40s; animation-delay: -5s, -15s; animation-direction: alternate, reverse; }

/* === 7. 猩紅權威 (Crimson Authority) === */
/* 說明：下落的條紋和光束使用主色。作為點綴的符文，其文字陰影從原來的白色改為輔色，與主色形成呼應。*/
.card-wrapper.bg-anim-crimson-authority .dynamic-bg-container { display: block; mix-blend-mode: lighten; filter: brightness(1.2); opacity: 0.9; }
.bg-anim-crimson-authority .particle { position: absolute; top: -20%; opacity: 0; animation-name: crimson-descent; animation-iteration-count: infinite; animation-timing-function: linear; will-change: transform, opacity; }
@keyframes crimson-descent { 0% { transform: translateY(0) rotate(var(--spin, 0deg)); opacity: 0; } 10% { opacity: var(--max-opacity, 0.8); } 90% { opacity: var(--max-opacity, 0.8); } 100% { transform: translateY(130vh) rotate(var(--spin, 0deg)); opacity: 0; } }
.bg-anim-crimson-authority .particle:nth-child(-n+4) { height: 150%; background: repeating-linear-gradient(to bottom, rgba(var(--secondary-theme-color-rgb), 0.6) 0, rgba(var(--secondary-theme-color-rgb), 0.6) 15px, transparent 15px, transparent 25px); filter: drop-shadow(0 0 5px rgba(0,0,0,0.8)); }
.bg-anim-crimson-authority .particle:nth-child(n+5):nth-child(-n+8) { height: 60vh; background: linear-gradient(to bottom, rgba(var(--secondary-theme-color-rgb), 0.8) 0%, transparent 100%); filter: blur(4px); }
.bg-anim-crimson-authority .particle:nth-child(n+9) { font-family: 'Times New Roman', serif; color: rgba(var(--secondary-theme-color-rgb), 1); text-shadow: 0 0 8px rgba(var(--secondary-theme-color-rgb), 1), 0 0 15px rgba(var(--primary-theme-color-rgb), 0.7); }
.bg-anim-crimson-authority .particle:nth-child(2n+9)::before { content: '❖'; }
.bg-anim-crimson-authority .particle:nth-child(2n+10)::before { content: '†'; }
.bg-anim-crimson-authority .p1 { left: 20%; width: 5px; --max-opacity: 0.5; animation-duration: 22s; animation-delay: -10s; }
.bg-anim-crimson-authority .p2 { left: 45%; width: 8px; --max-opacity: 0.7; animation-duration: 18s; animation-delay: -2s; }
.bg-anim-crimson-authority .p3 { left: 70%; width: 5px; --max-opacity: 0.5; animation-duration: 25s; animation-delay: -18s; }
.bg-anim-crimson-authority .p4 { left: 95%; width: 6px; --max-opacity: 0.6; animation-duration: 20s; animation-delay: -5s; }
.bg-anim-crimson-authority .p5 { left: 10%; width: 2px; --max-opacity: 0.8; animation-duration: 8s; animation-delay: -1s; }
.bg-anim-crimson-authority .p6 { left: 33%; width: 1px; --max-opacity: 0.6; animation-duration: 10s; animation-delay: -7s; }
.bg-anim-crimson-authority .p7 { left: 66%; width: 2px; --max-opacity: 0.8; animation-duration: 7s; animation-delay: -4s; }
.bg-anim-crimson-authority .p8 { left: 85%; width: 1.5px; --max-opacity: 0.7; animation-duration: 9s; animation-delay: -9s; }
.bg-anim-crimson-authority .p9 { left: 15%; font-size: 24px; --spin: 90deg; --max-opacity: 1; animation-duration: 15s; animation-delay: -3s; }
.bg-anim-crimson-authority .p10 { left: 55%; font-size: 30px; --spin: -120deg; --max-opacity: 1; animation-duration: 13s; animation-delay: -11s; }
.bg-anim-crimson-authority .p11 { left: 80%; font-size: 20px; --spin: 180deg; --max-opacity: 1; animation-duration: 17s; animation-delay: -8s; }
.bg-anim-crimson-authority .p12 { left: 25%; font-size: 28px; --spin: -60deg; --max-opacity: 1; animation-duration: 14s; animation-delay: -16s; }

/* === 8. 夢幻光彩 (Dreamy Radiance) === */
/* 說明：將一半的光球基礎色改為輔色，另一半保持主色。它們在動畫中都會進行色相旋轉，創造出兩種顏色交織變幻的夢幻效果。*/
.card-wrapper.bg-anim-dreamy-radiance .dynamic-bg-container {
    display: block;
    mix-blend-mode: screen;
    filter: brightness(1.1) saturate(1.2);
    opacity: 0.8;
}
.bg-anim-dreamy-radiance .particle {
    position: absolute;
    border-radius: 50%;
    background: radial-gradient(circle, rgba(var(--secondary-theme-color-rgb), 0.7) 0%, transparent 70%);
    animation-name: dreamy-drift; 
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out;
    animation-direction: alternate;
    will-change: transform, opacity, filter;
}
/* 將偶數粒子改為輔色 */
.bg-anim-dreamy-radiance .particle:nth-child(2n) {
    background: radial-gradient(circle, rgba(var(--primary-theme-color-rgb), 0.6) 0%, transparent 70%);
}
@keyframes dreamy-drift {
    from { transform: translate(0, 0) scale(1); opacity: 0.8; filter: blur(60px) hue-rotate(0deg); }
    to { transform: translate(var(--x, 40vw), var(--y, 30vh)) scale(var(--s, 1.5)); opacity: 1; filter: blur(40px) hue-rotate(120deg); }
}
.bg-anim-dreamy-radiance .p1 { width: 60vmin; height: 60vmin; top: 10%; left: -20%; --x: 40vw; --y: 20vh; --s: 1.2; animation-duration: 30s; animation-delay: -5s; }
.bg-anim-dreamy-radiance .p2 { width: 55vmin; height: 55vmin; top: 40%; left: 60%; --x: -30vw; --y: -30vh; --s: 1.3; animation-duration: 35s; animation-delay: -15s; animation-direction: alternate-reverse; }
.bg-anim-dreamy-radiance .p3 { width: 70vmin; height: 70vmin; top: -20%; left: 40%; --x: 10vw; --y: 50vh; --s: 1.1; animation-duration: 40s; animation-delay: -2s; }
.bg-anim-dreamy-radiance .p4 { width: 35vmin; height: 35vmin; top: 80%; left: 0%; --x: 60vw; --y: -40vh; --s: 1.5; animation-duration: 22s; animation-delay: -8s; }
.bg-anim-dreamy-radiance .p5 { width: 40vmin; height: 40vmin; top: 5%; left: 80%; --x: -50vw; --y: 30vh; --s: 1.4; animation-duration: 25s; animation-delay: -12s; animation-direction: alternate-reverse; }
.bg-anim-dreamy-radiance .p6 { width: 30vmin; height: 30vmin; top: 60%; left: 25%; --x: 20vw; --y: -50vh; --s: 1.6; animation-duration: 28s; animation-delay: -20s; }
.bg-anim-dreamy-radiance .p7 { width: 20vmin; height: 20vmin; top: 30%; left: 10%; --x: 80vw; --y: 10vh; --s: 2; animation-duration: 15s; animation-delay: -3s; }
.bg-anim-dreamy-radiance .p8 { width: 25vmin; height: 25vmin; top: 70%; left: 75%; --x: -70vw; --y: -20vh; --s: 1.8; animation-duration: 18s; animation-delay: -9s; animation-direction: alternate-reverse; }
.bg-anim-dreamy-radiance .p9 { width: 18vmin; height: 18vmin; top: 0%; left: 50%; --x: 10vw; --y: 80vh; --s: 2.2; animation-duration: 20s; animation-delay: -1s; }
.bg-anim-dreamy-radiance .p10 { width: 45vmin; height: 45vmin; top: 90%; left: 30%; --x: -20vw; --y: -80vh; --s: 1.3; animation-duration: 33s; animation-delay: -25s; }
.bg-anim-dreamy-radiance .p11 { width: 22vmin; height: 22vmin; top: 50%; left: 50%; --x: 30vw; --y: -30vh; --s: 1.9; animation-duration: 16s; animation-delay: -6s; animation-direction: alternate-reverse; }
.bg-anim-dreamy-radiance .p12 { width: 38vmin; height: 38vmin; top: 20%; left: 70%; --x: -60vw; --y: 40vh; --s: 1.4; animation-duration: 26s; animation-delay: -18s; }

/* === 9. 海洋之息 (Oceanic Breath) === */
/* 說明：將氣泡的材質從原來的白色高光改為輔色高光，主體漸變至主色，使氣泡色彩更豐富且貼合主題。外圈輝光也加入了輔色。*/
.card-wrapper.bg-anim-oceanic-breath .dynamic-bg-container { display: block; filter: blur(1px) brightness(1.2); mix-blend-mode: screen; }
.bg-anim-oceanic-breath .particle {
    position: absolute;
    bottom: -20%;
    opacity: 0;
    border-radius: 50%;
    background: radial-gradient(circle at 30% 30%, rgba(var(--primary-theme-color-rgb), 0.8) 0%, rgba(var(--primary-theme-color-rgb), 0.2) 30%, rgba(var(--secondary-theme-color-rgb), 0.6) 100%);
    box-shadow: inset 0 0 8px rgba(0,0,0,0.3), 0 0 15px rgba(var(--secondary-theme-color-rgb), 0.6), 0 0 5px rgba(var(--primary-theme-color-rgb), 0.5);
    animation-name: oceanic-drift;
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out;
    will-change: transform, opacity;
}
@keyframes oceanic-drift { 0% { transform: translate(var(--x-start, 0px), 0); opacity: 0; } 10% { opacity: 0.8; } 100% { transform: translate(var(--x-end, 0px), -120vh) rotate(var(--rot, 0deg)); opacity: 0; } }
.bg-anim-oceanic-breath .p1 { left: 10%; width: 60px; height: 60px; --x-start: 0vw; --x-end: -5vw; --rot: -30deg; animation-duration: 14s; animation-delay: -2s; }
.bg-anim-oceanic-breath .p2 { left: 80%; width: 75px; height: 75px; --x-start: 0vw; --x-end: 8vw;  --rot: 40deg;  animation-duration: 12s; animation-delay: -8s; }
.bg-anim-oceanic-breath .p3 { left: 40%; width: 50px; height: 50px; --x-start: 0vw; --x-end: 10vw; --rot: 20deg;  animation-duration: 18s; animation-delay: -5s; }
.bg-anim-oceanic-breath .p4 { left: 20%; width: 35px; height: 35px; filter: blur(2px); --x-start: 0vw; --x-end: -8vw; --rot: -50deg; animation-duration: 25s; animation-delay: -1s; }
.bg-anim-oceanic-breath .p5 { left: 65%; width: 45px; height: 45px; filter: blur(1.5px); --x-start: 0vw; --x-end: 6vw;  --rot: 60deg;  animation-duration: 22s; animation-delay: -12s; }
.bg-anim-oceanic-breath .p6 { left: 90%; width: 40px; height: 40px; filter: blur(2px); --x-start: 0vw; --x-end: -12vw; --rot: -25deg; animation-duration: 28s; animation-delay: -18s; }
.bg-anim-oceanic-breath .p7 { left: 5%; width: 25px; height: 25px; filter: blur(4px); --x-start: 0vw; --x-end: 4vw;  --rot: 80deg;  animation-duration: 35s; animation-delay: -4s; }
.bg-anim-oceanic-breath .p8 { left: 50%; width: 30px; height: 30px; filter: blur(3px); --x-start: 0vw; --x-end: -5vw; --rot: -70deg; animation-duration: 32s; animation-delay: -25s; }
.bg-anim-oceanic-breath .p9 { left: 75%; width: 20px; height: 20px; filter: blur(4.5px); --x-start: 0vw; --x-end: 10vw; --rot: 90deg;  animation-duration: 40s; animation-delay: -30s; }
.bg-anim-oceanic-breath .p10 { left: 30%; width: 15px; height: 15px; filter: blur(1px); --x-start: 0vw; --x-end: -15vw; --rot: -120deg; animation-duration: 15s; animation-delay: -10s; }
.bg-anim-oceanic-breath .p11 { left: 60%; width: 18px; height: 18px; filter: blur(0.5px); --x-start: 0vw; --x-end: 12vw; --rot: 100deg; animation-duration: 19s; animation-delay: -15s; }
.bg-anim-oceanic-breath .p12 { left: 2%; width: 20px; height: 20px; filter: blur(3px); --x-start: 0vw; --x-end: 5vw; --rot: 45deg; animation-duration: 26s; animation-delay: -22s; }

/* === 10. 水晶晶格 (Crystalline Lattice) === */
/* 說明：保持晶格內部漸變為主色，將銳利的邊框改為輔色，形成清晰的輪廓。整體的輝光也疊加了輔色。*/
.card-wrapper.bg-anim-crystalline-lattice .dynamic-bg-container { display: grid; grid-template-columns: repeat(3, 1fr); grid-template-rows: repeat(4, 1fr); place-items: center; transform: scale(1.5) rotate(15deg); opacity: 0.7; filter: drop-shadow(0 0 8px rgba(var(--secondary-theme-color-rgb), 0.4)) drop-shadow(0 0 4px rgba(var(--primary-theme-color-rgb), 0.3)); }
.bg-anim-crystalline-lattice .particle { width: 90%; height: 90%; background: radial-gradient(circle, rgba(var(--secondary-theme-color-rgb), 0.5) 0%, rgba(var(--secondary-theme-color-rgb), 0.1) 70%); border: 1px solid rgba(var(--primary-theme-color-rgb), 0.7); clip-path: polygon(50% 0%, 100% 25%, 100% 75%, 50% 100%, 0% 75%, 0% 25%); animation-name: crystal-resonate; animation-duration: 4s; animation-iteration-count: infinite; animation-timing-function: cubic-bezier(0.5, 0, 0.5, 1); will-change: transform, filter, opacity; }
@keyframes crystal-resonate { 0%, 100% { transform: scale(0.6); filter: brightness(0.7); opacity: 0.7; } 50% { transform: scale(1); filter: brightness(1.5); opacity: 1; } }
.bg-anim-crystalline-lattice .p1 { animation-delay: -0.0s; }
.bg-anim-crystalline-lattice .p2, .bg-anim-crystalline-lattice .p4 { animation-delay: -0.2s; }
.bg-anim-crystalline-lattice .p3, .bg-anim-crystalline-lattice .p5, .bg-anim-crystalline-lattice .p7 { animation-delay: -0.4s; }
.bg-anim-crystalline-lattice .p6, .bg-anim-crystalline-lattice .p8, .bg-anim-crystalline-lattice .p10 { animation-delay: -0.6s; }
.bg-anim-crystalline-lattice .p9, .bg-anim-crystalline-lattice .p11 { animation-delay: -0.8s; }
.bg-anim-crystalline-lattice .p12 { animation-delay: -1.0s; }
.bg-anim-crystalline-lattice .p5, .bg-anim-crystalline-lattice .p11 { transform: rotate(90deg); }
.bg-anim-crystalline-lattice .p3, .bg-anim-crystalline-lattice .p8 { animation-direction: reverse; }

/* === 11. 機巧樞紐 (Machina Core) === */
/* 說明：這是一個複雜的機械結構。將幾個旋轉的齒輪和裝飾環的顏色從主色改為輔色，以區分不同的機械部件。閃爍的指示燈輝光也加入了輔色。*/
.card-wrapper.bg-anim-machina-core .dynamic-bg-container { display: block; background: repeating-linear-gradient(to bottom, transparent, transparent 1px, rgba(0, 0, 0, 0.2) 2px, rgba(0, 0, 0, 0.2) 3px); overflow: hidden; }
.bg-anim-machina-core .particle { position: absolute; will-change: transform, opacity; animation-iteration-count: infinite; animation-timing-function: linear; }
@keyframes machina-spin-cw { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
@keyframes machina-spin-ccw { from { transform: rotate(0deg); } to { transform: rotate(-360deg); } }
@keyframes machina-piston { from { transform: translateY(-100%); } to { transform: translateY(100%); } }
@keyframes machina-flow-h { from { background-position: 0 0; } to { background-position: 200px 0; } }
@keyframes machina-flow-v { from { background-position: 0 0; } to { background-position: 0 200px; } }
@keyframes machina-indicator-blink { 0%, 100% { opacity: 1; } 50% { opacity: 0.3; } }
.bg-anim-machina-core .p1, .bg-anim-machina-core .p2 { border-style: dashed; border-radius: 50%; opacity: 0.2; z-index: 1; animation-name: machina-spin-cw; }
.bg-anim-machina-core .p1 { top: -20%; left: -25%; width: 80vmin; height: 80vmin; border: 30px dashed rgba(var(--secondary-theme-color-rgb), 0.5); animation-duration: 80s; }
.bg-anim-machina-core .p2 { top: 40%; left: 50%; width: 70vmin; height: 70vmin; border: 20px dashed rgba(var(--primary-theme-color-rgb), 0.4); animation-name: machina-spin-ccw; animation-duration: 60s; animation-delay: -5s; }
.bg-anim-machina-core .p3, .bg-anim-machina-core .p4, .bg-anim-machina-core .p5 { border-radius: 50%; opacity: 0.4; z-index: 2; animation-name: machina-spin-cw; }
.bg-anim-machina-core .p3 { top: 30%; left: 35%; width: 30vmin; height: 30vmin; border: 2px solid rgba(var(--secondary-theme-color-rgb), 0.8); background: repeating-conic-gradient(rgba(var(--secondary-theme-color-rgb), 0.3) 0% 5%, transparent 5% 10%); animation-duration: 25s; }
.bg-anim-machina-core .p4 { top: 5%; right: -5%; width: 25vmin; height: 25vmin; border: 5px double rgba(var(--primary-theme-color-rgb), 0.5); animation-name: machina-spin-ccw; animation-duration: 15s; }
.bg-anim-machina-core .p5 { bottom: -5%; left: 5%; width: 20vmin; height: 20vmin; background: radial-gradient(transparent 40%, rgba(var(--secondary-theme-color-rgb), 0.4) 42%, transparent 45%); border: none; animation-duration: 18s; }
.bg-anim-machina-core .p6, .bg-anim-machina-core .p7 { width: 5vmin; background: rgba(var(--secondary-theme-color-rgb), 0.3); z-index: 2; animation-name: machina-piston; animation-timing-function: ease-in-out; animation-direction: alternate; }
.bg-anim-machina-core .p6 { top: 50%; left: 15%; height: 60%; animation-duration: 6s; animation-delay: -1s; }
.bg-anim-machina-core .p7 { top: 50%; right: 20%; height: 40%; animation-duration: 4s; animation-delay: -3s; }
.bg-anim-machina-core .p8 { top: 20%; left: 0; width: 100%; height: 3px; background: linear-gradient(90deg, transparent 0%, rgba(var(--secondary-theme-color-rgb), 1) 50%, transparent 100%); background-size: 100px 100%; z-index: 3; opacity: 0.6; filter: blur(1px) brightness(1.2); animation-name: machina-flow-h; animation-duration: 3s; }
.bg-anim-machina-core .p9 { top: 0; left: 80%; width: 3px; height: 100%; background: linear-gradient(180deg, transparent 0%, rgba(var(--secondary-theme-color-rgb), 1) 50%, transparent 100%); background-size: 100% 100px; z-index: 3; opacity: 0.6; filter: blur(1px) brightness(1.2); animation-name: machina-flow-v; animation-duration: 2.5s; animation-delay: -0.5s; }
.bg-anim-machina-core .p10, .bg-anim-machina-core .p11, .bg-anim-machina-core .p12 { border-radius: 50%; background-color: rgba(var(--secondary-theme-color-rgb), 1); box-shadow: 0 0 8px rgba(var(--secondary-theme-color-rgb), 1), 0 0 15px rgba(var(--primary-theme-color-rgb), 0.6); z-index: 4; animation-name: machina-indicator-blink; animation-timing-function: steps(1, end); }
.bg-anim-machina-core .p10 { top: 18%; left: 45%; width: 10px; height: 10px; animation-duration: 2s; animation-delay: -0.2s; }
.bg-anim-machina-core .p11 { top: 78%; left: 13%; width: 15px; height: 15px; animation-duration: 3.5s; animation-delay: -1.5s; }
.bg-anim-machina-core .p12 { top: 40%; right: 10%; width: 8px; height: 8px; animation-duration: 1.8s; animation-delay: -0.8s; }

/* === 12. 光譜漂移 (Spectral Drift) === */
/* 說明：類似絨毛狂熱，將一半的粒子基礎色改為輔色，创造主色和辅色兩種幽靈般的形态交織漂浮的景象。*/
.card-wrapper.bg-anim-spectral-drift .dynamic-bg-container {
    display: block;
    filter: brightness(1.1);
    overflow: hidden;
}
.bg-anim-spectral-drift .particle {
    position: absolute;
    opacity: 0;
    background-color: rgba(var(--secondary-theme-color-rgb), 0.4);
    border-radius: 45% 55% 60% 40% / 55% 45% 55% 45%; 
    filter: blur(40px);
    animation-name: spectral-wisp-float, spectral-wisp-morph;
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out;
}
/* 將偶數粒子改為輔色 */
.bg-anim-spectral-drift .particle:nth-child(2n) {
    background-color: rgba(var(--primary-theme-color-rgb), 0.35);
}
@keyframes spectral-wisp-float {
    0% { transform: translate(0, 0) scale(1) rotate(0deg); opacity: 0.8; }
    100% { transform: translate(25vw, -30vh) scale(1.5) rotate(90deg); opacity: 0.5; }
}
@keyframes spectral-wisp-morph { 0% { border-radius: 45% 55% 60% 40% / 55% 45% 55% 45%; } 50% { border-radius: 60% 40% 45% 55% / 40% 60% 45% 55%; } 100% { border-radius: 45% 55% 60% 40% / 55% 45% 55% 45%; } }
.bg-anim-spectral-drift .p1 { width: 40vw; height: 50vh; top: 50%; left: 10%; animation-duration: 25s, 35s; animation-delay: -5s, -10s; animation-direction: alternate, normal; }
.bg-anim-spectral-drift .p2 { width: 30vw; height: 35vh; top: 10%; left: 60%; animation-duration: 18s, 28s; animation-delay: 0s, -15s; animation-direction: alternate-reverse, normal; }
.bg-anim-spectral-drift .p3 { width: 50vw; height: 20vh; top: 80%; left: 40%; animation-duration: 30s, 20s; animation-delay: -12s, -3s; animation-direction: alternate, normal; }
.bg-anim-spectral-drift .p4 { width: 25vw; height: 45vh; top: -10%; left: 20%; animation-duration: 22s, 32s; animation-delay: -8s, -18s; animation-direction: alternate-reverse, normal; }
.bg-anim-spectral-drift .p5 { width: 35vw; height: 30vh; bottom: 5%; right: 5%; animation-duration: 19s, 26s; animation-delay: -2s, -9s; animation-direction: alternate, normal; }
.bg-anim-spectral-drift .p6 { width: 20vw; height: 60vh; top: 20%; left: 75%; animation-duration: 28s, 18s; animation-delay: -14s, -2s; animation-direction: alternate-reverse, normal; }
.bg-anim-spectral-drift .p7 { width: 45vw; height: 40vh; top: 30%; left: -10%; animation-duration: 26s, 38s; animation-delay: -3s, -20s; animation-direction: alternate, normal; }
.bg-anim-spectral-drift .p8 { width: 38vw; height: 25vh; bottom: 10%; left: 70%; animation-duration: 21s, 29s; animation-delay: -9s, -1s; animation-direction: alternate-reverse, normal; }
.bg-anim-spectral-drift .p9 { width: 28vw; height: 55vh; top: -15%; right: -5%; animation-duration: 32s, 22s; animation-delay: -1s, -11s; animation-direction: alternate, normal; }
.bg-anim-spectral-drift .p10 { width: 33vw; height: 33vh; top: 50%; left: 50%; animation-duration: 16s, 24s; animation-delay: -6s, -16s; animation-direction: alternate-reverse, normal; }
.bg-anim-spectral-drift .p11 { width: 42vw; height: 28vh; top: 75%; left: 0%; animation-duration: 29s, 19s; animation-delay: -18s, -8s; animation-direction: alternate, normal; }
.bg-anim-spectral-drift .p12 { width: 22vw; height: 50vh; bottom: -10%; left: 30%; animation-duration: 23s, 33s; animation-delay: -13s, -23s; animation-direction: alternate-reverse, normal; }


/* === 13. 深淵凝視 (Void Gaze) === */
/* 說明：眼睛的核心（虹膜）改為从輔色到主色的漸變，增加視覺焦點。周圍扭曲的觸鬚狀物體中，有一個改為輔色以增加混亂感。漂浮的星點輝光也加入了輔色。*/
.card-wrapper.bg-anim-void-gaze .dynamic-bg-container {
    display: block;
    background-color: rgb(5, 0, 10);
    overflow: hidden;
    opacity: 0.4; /* 調整了透明度以更好地融入深色背景 */
}
.bg-anim-void-gaze .particle {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%);
    animation-iteration-count: infinite;
    animation-timing-function: ease-in-out;
    will-change: transform, opacity, filter;
}
@keyframes void-gaze-upper-lid { 0%, 10%, 90%, 100% { transform: translateY(0%); } 30%, 70% { transform: translateY(-100%); } }
@keyframes void-gaze-lower-lid { 0%, 10%, 90%, 100% { transform: translateY(0%); } 30%, 70% { transform: translateY(100%); } }
@keyframes void-iris-pulse { 0% { filter: brightness(1) hue-rotate(0deg); transform: translate(-50%, -50%) scale(1); } 50% { filter: brightness(2) hue-rotate(90deg); transform: translate(-50%, -50%) scale(1.15); } 100% { filter: brightness(1) hue-rotate(0deg); transform: translate(-50%, -50%) scale(1); } }
@keyframes void-writhe { 0% { transform: translate(-50%, -50%) rotate(-15deg) skew(5deg, 5deg); opacity: 0.6; } 50% { transform: translate(-40%, -60%) rotate(10deg) skew(-10deg, -5deg) scale(1.15); opacity: 1; } 100% { transform: translate(-55%, -45%) rotate(-5deg) skew(10deg, 10deg); opacity: 0.5; } }
@keyframes void-drift { from { opacity: 0; transform: var(--start-pos) scale(0.5); } to { opacity: 0.7; transform: translate(-50%, -50%) scale(1); } }

.bg-anim-void-gaze .p1 { width: 80vmin; height: 80vmin; background: radial-gradient(circle, transparent 40%, rgba(var(--secondary-theme-color-rgb), 0.3) 100%); border-radius: 50%; opacity: 0.5; z-index: 1; }
.bg-anim-void-gaze .p2 { width: 40vmin; height: 40vmin; background: radial-gradient(circle, rgba(var(--primary-theme-color-rgb), 0.9), rgba(var(--secondary-theme-color-rgb), 0.6) 60%, transparent 80%); border-radius: 50%; z-index: 2; animation-name: void-iris-pulse; animation-duration: 12s; }
.bg-anim-void-gaze .p3 { width: 3vmin; height: 38vmin; background-color: #000; border-radius: 20px; box-shadow: 0 0 10px #000; z-index: 3; }
.bg-anim-void-gaze .p4, .bg-anim-void-gaze .p5 { left: 0; width: 100%; height: 50%; background-color: rgb(5, 0, 10); z-index: 4; animation-duration: 12s; animation-timing-function: cubic-bezier(0.65, 0, 0.35, 1); transform: translateY(0); }
.bg-anim-void-gaze .p4 { top: 0; animation-name: void-gaze-upper-lid; }
.bg-anim-void-gaze .p5 { top: 50%; animation-name: void-gaze-lower-lid; }
.bg-anim-void-gaze .p6, .bg-anim-void-gaze .p7, .bg-anim-void-gaze .p8 { filter: blur(20px); mix-blend-mode: screen; opacity: 1; z-index: 1; animation-name: void-writhe; animation-direction: alternate; }
.bg-anim-void-gaze .p6 { width: 10vmin; height: 80vmin; top: 50%; left: 20%; background: rgba(var(--secondary-theme-color-rgb), 0.7); animation-duration: 22s; animation-delay: -2s; }
.bg-anim-void-gaze .p7 { width: 15vmin; height: 70vmin; top: 50%; left: 80%; transform: rotate(30deg); background: rgba(var(--primary-theme-color-rgb), 0.6); animation-duration: 18s; animation-delay: -8s; }
.bg-anim-void-gaze .p8 { width: 12vmin; height: 90vmin; top: 50%; left: 50%; transform: rotate(-45deg); background: rgba(var(--secondary-theme-color-rgb), 0.7); animation-duration: 15s; animation-delay: -5s; }
.bg-anim-void-gaze .p9, .bg-anim-void-gaze .p10, .bg-anim-void-gaze .p11, .bg-anim-void-gaze .p12 { width: 5px; height: 5px; background-color: #fff; border-radius: 50%; box-shadow: 0 0 5px #fff, 0 0 10px rgba(var(--primary-theme-color-rgb), 0.7); animation-name: void-drift; animation-timing-function: ease-in; z-index: 5; }
.bg-anim-void-gaze .p9 { --start-pos: translate(-40vw, -45vh); animation-duration: 18s; animation-delay: -2s; }
.bg-anim-void-gaze .p10 { --start-pos: translate(45vw, -30vh); animation-duration: 15s; animation-delay: -8s; }
.bg-anim-void-gaze .p11 { --start-pos: translate(-35vw, 40vh); animation-duration: 22s; animation-delay: -5s; }
.bg-anim-void-gaze .p12 { --start-pos: translate(30vw, 48vh); animation-duration: 12s; animation-delay: -11s; }

/* === 14. 奇美拉流 (Chimeric Flow) === */
.card-wrapper.bg-anim-chimeric-flow .dynamic-bg-container {
    display: block;
    overflow: hidden; 
}
.bg-anim-chimeric-flow .particle {
    position: absolute;
    opacity: 0;
    animation-iteration-count: infinite;
    will-change: transform, opacity, filter;
}
@keyframes chimeric-morph-wander {
    0% { transform: translate(0, 0) scale(1); border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; filter: hue-rotate(0deg) blur(30px); }
    50% { transform: translate(var(--x, 10vw), var(--y, 15vh)) scale(1.2); border-radius: 70% 30% 30% 70% / 70% 70% 30% 30%; filter: hue-rotate(180deg) blur(30px); }
    100% { transform: translate(0, 0) scale(1); border-radius: 40% 60% 70% 30% / 40% 50% 60% 50%; filter: hue-rotate(360deg) blur(30px); }
}
@keyframes chimeric-glitch-flicker {
    0% { opacity: 0; transform: translate(0, 0) rotate(0deg); }
    20% { opacity: 1; transform: translate(5px, -10px) rotate(15deg); }
    40% { opacity: 0.3; transform: translate(-15px, 5px) rotate(-10deg); }
    60% { opacity: 1; transform: translate(10px, 10px) rotate(5deg); }
    80% { opacity: 0.5; transform: translate(-5px, -5px) rotate(0deg); }
    100% { opacity: 0; transform: translate(0, 0) rotate(-15deg); }
}
@keyframes chimeric-scan-scroll {
    from { transform: translateY(-20vh); } to { transform: translateY(120vh); }
}
.bg-anim-chimeric-flow .particle:nth-child(-n+4) {
    mix-blend-mode: soft-light;
    background: radial-gradient(circle, rgba(var(--secondary-theme-color-rgb), 0.7), rgba(var(--secondary-theme-color-rgb), 0.2) 70%);
    animation-name: chimeric-morph-wander;
    animation-timing-function: ease-in-out;
    z-index: 1;
}
.bg-anim-chimeric-flow .particle:nth-child(n+5):nth-child(-n+8) {
    background-color: #fff;
    box-shadow: 0 0 10px #fff, 0 0 20px rgba(var(--secondary-theme-color-rgb), 0.8);
    animation-name: chimeric-glitch-flicker;
    animation-timing-function: steps(1, end);
    z-index: 3;
}
.bg-anim-chimeric-flow .particle:nth-child(n+9) {
    left: 0;
    width: 100%;
    height: 2px;
    background-color: #fff;
    box-shadow: 0 0 5px rgba(var(--secondary-theme-color-rgb), 0.7), 0 0 10px rgba(var(--secondary-theme-color-rgb), 0.5);
    animation-name: chimeric-scan-scroll;
    animation-timing-function: linear;
    z-index: 4;
}
.bg-anim-chimeric-flow .p1 { top: -20%; left: -20%; width: 70vmin; height: 70vmin; --x: 30vw; --y: 40vh; animation-duration: 22s; animation-delay: -5s; opacity: 0.6; }
.bg-anim-chimeric-flow .p2 { top: 50%; left: -30%; width: 80vmin; height: 80vmin; --x: 40vw; --y: -30vh; animation-duration: 25s; animation-delay: -15s; opacity: 0.6; }
.bg-anim-chimeric-flow .p3 { top: -10%; left: 60%; width: 60vmin; height: 60vmin; --x: -50vw; --y: 50vh; animation-duration: 20s; animation-delay: -2s; opacity: 0.6; }
.bg-anim-chimeric-flow .p4 { top: 60%; left: 70%; width: 75vmin; height: 75vmin; --x: -30vw; --y: -60vh; animation-duration: 28s; animation-delay: -12s; opacity: 0.6; }
.bg-anim-chimeric-flow .p5 { top: 20%; left: 30%; width: 10px; height: 10px; animation-duration: 2s; animation-delay: -0.5s; }
.bg-anim-chimeric-flow .p6 { top: 80%; left: 10%; width: 15px; height: 15px; animation-duration: 1.5s; animation-delay: -1.2s; }
.bg-anim-chimeric-flow .p7 { top: 50%; left: 85%; width: 12px; height: 12px; animation-duration: 2.5s; animation-delay: -2s; }
.bg-anim-chimeric-flow .p8 { top: 10%; left: 60%; width: 8px; height: 8px; animation-duration: 1.8s; animation-delay: -0.8s; }
.bg-anim-chimeric-flow .p9 { top: 0; animation-duration: 12s; animation-delay: -8s; opacity: 0.4; }
.bg-anim-chimeric-flow .p10 { top: 0; animation-duration: 8s; animation-delay: -2s; opacity: 0.6; }
.bg-anim-chimeric-flow .p11 { top: 0; animation-duration: 15s; animation-delay: -14s; opacity: 0.3; }
.bg-anim-chimeric-flow .p12 { top: 0; animation-duration: 10s; animation-delay: -5s; opacity: 0.5; }

        /* --- LAYOUT & DECORATION STYLES START --- */
        .frame-layer { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; pointer-events: none; display: none; }
        .frame-svg { width: 100%; height: 100%; fill: none; stroke: var(--secondary-theme-color); stroke-width: 2.5; filter: drop-shadow(0 0 5px rgba(var(--secondary-theme-color-rgb), 0.8)); vector-effect: non-scaling-stroke; }
        
        .high-tier .character-sheet, .deluxe-tier .character-sheet { border-top-width: 4px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7), 0 0 20px rgba(var(--secondary-theme-color-rgb), 0.25); }
        .deluxe-tier .frame-svg { stroke-width: 3; filter: drop-shadow(0 0 15px rgba(var(--secondary-theme-color-rgb), 0.7)); }
        
        @keyframes deluxe-halo-pulse { 0%, 100% { opacity: 0.7; transform: scale(1.0); } 50% { opacity: 1.0; transform: scale(1.01); } }
        .frame-deluxe-halo { stroke-width: 1.5; opacity: 0.7; animation: deluxe-halo-pulse 4s infinite ease-in-out; transform-origin: center center; }

        .tier-6 .character-sheet { animation: legendary-pulse 4s infinite ease-in-out; }
        @keyframes legendary-pulse { 0% { border-color: rgba(var(--secondary-theme-color-rgb), 0.6); box-shadow: 0 0 20px rgba(var(--secondary-theme-color-rgb), 0.2); } 50% { border-color: rgba(var(--secondary-theme-color-rgb), 1.0); box-shadow: 0 0 40px rgba(var(--secondary-theme-color-rgb), 0.4); } 100% { border-color: rgba(var(--secondary-theme-color-rgb), 0.6); box-shadow: 0 0 20px rgba(var(--secondary-theme-color-rgb), 0.2); } }
        
        .sheet-header, .sheet-body { position: relative; z-index: 2; }
        .sheet-header { background: linear-gradient(145deg, transparent, rgba(0,0,0,0.2)); padding: 25px 20px 15px; text-align: center; position: relative; }
        .sheet-header::after { content: ''; position: absolute; bottom: 0; left: 10%; right: 10%; height: 2px; background: linear-gradient(to right, transparent, rgba(var(--secondary-theme-color-rgb), 0.7), transparent); filter: blur(1px); }
        .char-name { 
            display: inline-block; font-family: var(--font-primary); font-size: 2.5rem; font-weight: 700; margin: 0; 
            letter-spacing: 2px; cursor: pointer; position: relative; color: #383838; 
            text-shadow: 
                1px 0 0 var(--primary-theme-color), -1px 0 0 var(--primary-theme-color),
                0 1px 0 var(--primary-theme-color), 0 -1px 0 var(--primary-theme-color),
                1px 1px 0 var(--primary-theme-color), -1px -1px 0 var(--primary-theme-color),
                1px -1px 0 var(--primary-theme-color), -1px 1px 0 var(--primary-theme-color),
                2px 0 0 var(--primary-theme-color), -2px 0 0 var(--primary-theme-color),
                0 2px 0 var(--primary-theme-color), 0 -2px 0 var(--primary-theme-color);
        }
        .char-sub-info { display: flex; justify-content: center; align-items: center; gap: 1.5rem; margin-top: 0.25rem; }
        .char-level, .char-tier { font-size: 1rem; color: var(--text-muted-color); display: flex; align-items: center; }
        .char-level::before, .char-tier::before { content: '◆'; color: var(--secondary-theme-color); margin-right: 0.5em; font-size: 0.9em; opacity: 0.8; }
        .sheet-body { padding: 15px 20px; }
        .visually-hidden { position: absolute; width: 1px; height: 1px; margin: -1px; padding: 0; overflow: hidden; clip: rect(0, 0, 0, 0); border: 0; }
        .info-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 10px; width: 100%; position: relative; }
        .info-grid::before { content: ''; position: absolute; top: 50%; left: 50%; width: 140px; height: 140px; background: radial-gradient(circle, rgba(var(--primary-theme-color-rgb), 0.4) 0%, transparent 70%); transform: translate(-50%, -50%); border-radius: 50%; animation: glow-pulse 5s infinite ease-in-out; pointer-events: none; }
        .info-item { background: #222; padding: 0.625rem; border-radius: 5px; text-align: center; position: relative; z-index: 1; }
        .info-grid .info-item:nth-child(1) { border-bottom-right-radius: 30px; } .info-grid .info-item:nth-child(2) { border-bottom-left-radius: 30px; } .info-grid .info-item:nth-child(3) { border-top-right-radius: 30px; } .info-grid .info-item:nth-child(4) { border-top-left-radius: 30px; }
        .info-label { display: block; font-size: 0.9rem; color: var(--text-muted-color); } 
        .info-value { font-size: 1.2rem; font-weight: bold; }
        .info-item[data-race-item] .info-value { color: var(--primary-theme-color); font-weight: 400; text-shadow: 0 0 8px rgba(var(--primary-theme-color-rgb), 0.7); }
        .core-info-placeholder { opacity: 0.6; user-select: none; background-color: #222; display: flex; justify-content: center; align-items: center;}
        .core-info-placeholder .info-value { color: var(--text-muted-color); text-shadow: 1px 0 0 var(--secondary-theme-color), 0 1px 0 var(--secondary-theme-color), -1px 0 0 var(--secondary-theme-color), 0 -1px 0 var(--secondary-theme-color); }
        
        .attributes-grid { display: grid; gap: 8px; width: 100%; position: relative; }
        .attributes-grid::before, .attributes-grid::after { content: ''; position: absolute; width: 24px; height: 24px; background: transparent; border: 3px solid var(--secondary-theme-color); transform-origin: center; pointer-events: none; z-index: 0; display: none;  transform: translate(-50%, -50%) rotate(45deg); }
        .attribute-item { position: relative; z-index: 1; }
        .attribute-item .attribute-box { background: #333; padding: 0.625rem 0.9rem; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; transition: background-color 0.3s ease; position: relative; min-height: 40px; }
        .attribute-item.is-collapsible .attribute-box { cursor: pointer; }
        .attribute-item .attribute-box:hover { background-color: #404040; }
        .attribute-item.show-formula .attribute-box { background-color: #2a2a2a; }
        .attribute-name { font-weight: bold; } 
        .attribute-value-container { text-align: right; }
        .attribute-total { font-size: 1.5rem; font-weight: bold; color: var(--primary-theme-color); }
        .attribute-details { display: none; font-size: 0.9rem; color: var(--text-muted-color); }
        .attribute-item.show-formula .attribute-total { display: none; }
        .attribute-item.show-formula .attribute-details { display: block; }
        .placeholder-item { opacity: 0.6; user-select: none; pointer-events: none; }
        .placeholder-item .attribute-box { justify-content: center; }
        .placeholder-item .attribute-box:hover { background-color: #333; }
        .placeholder-item .attribute-total { margin: 0; padding: 0; }
        .vitals-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; }
        .vital-item { padding: 0.625rem; text-align: center; position: relative; overflow: hidden; cursor: pointer; clip-path: polygon(15px 0, 100% 0, 100% calc(100% - 15px), calc(100% - 15px) 100%, 0 100%, 0 15px); box-shadow: inset 0 0 15px rgba(0,0,0,0.7); }
        .vital-item::after { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAyMDAgMjAwIj48ZmlsdGVyIGlkPSJub2lzZSI+PGZlVHVyYnVsZW5jZSB0eXBlPSJmcmFjdGFsTm9pc2UiIGJhc2VGcmVxdWVuY3k9IjAuNjUiIG51bU9jdGF2ZXM9IjMiIHN0aXRjaFRpbGVzPSJzdGl0Y2giLz48L2ZpbHRlcj48cmVjdCB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCIgZmlsdGVyPSJ1cmwoI25vaXNlKSIvPjwvc3ZnPg=='); opacity: 0.05; z-index: 1; pointer-events: none; }
        .vital-item.hp { background: linear-gradient(180deg, rgba(220, 20, 60, 0.3) 0%, rgba(80, 10, 20, 0.7) 100%); }
        .vital-item.mp { background: linear-gradient(180deg, rgba(30, 144, 255, 0.3) 0%, rgba(10, 40, 80, 0.7) 100%); }
        .vital-item.sp { background: linear-gradient(180deg, rgba(173, 255, 47, 0.3) 0%, rgba(60, 80, 20, 0.7) 100%); }
        .vital-label, .vital-value { transition: color 0.2s ease; position: relative; z-index: 3; }
        .vital-label { display: block; font-weight: bold; } .vital-value { font-size: 1.2rem; }
        .card { background: #333; border-left: 4px solid var(--secondary-theme-color); border-radius: 0 5px 5px 0; padding: 0.9375rem; margin-bottom: 0.75rem; transition: background-color 0.2s ease-out; }
        .card:hover { background-color: #404040; } .card:active { background-color: #2a2a2a; }
        .card-header { display: flex; justify-content: space-between; align-items: baseline; margin-bottom: 0.625rem; }
        .card-title { font-size: 1.4rem; font-weight: bold; margin: 0; } .card-subtitle { font-size: 0.9rem; color: var(--text-muted-color); }
        .card-tags { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 0.625rem; }
        .card-tag { background: #444; color: #ccc; padding: 3px 8px; border-radius: 10px; font-size: 0.8rem; }
        .card-body p { margin: 5px 0 0; line-height: 1.6; } .card-label { font-weight: bold; color: var(--secondary-theme-color); }
        .story { background-color: #222; padding: 1rem; border-radius: 5px; line-height: 1.7; }
        
        .subsection-title { font-family: var(--font-primary); font-size: 1.5rem; color: var(--secondary-theme-color); margin-top: 1rem; margin-bottom: 0.5rem; border-left: 3px solid rgba(var(--secondary-theme-color-rgb), 0.5); padding-left: 0.625rem; font-weight: bold; }
        .profile-text-block { background-color: #222; padding: 1rem; border-radius: 5px; margin-bottom: 1rem; line-height: 1.7; font-size: 0.95rem; white-space: pre-wrap; color: var(--text-color); }
        .godhood-display { grid-column: 1 / -1; background: linear-gradient(90deg, transparent, rgba(var(--primary-theme-color-rgb), 0.2), transparent); padding: 5px; text-align: center; border-top: 1px solid var(--primary-theme-color); border-bottom: 1px solid var(--primary-theme-color); margin-bottom: 10px; font-family: var(--font-primary); letter-spacing: 2px; font-weight: bold; color: var(--text-color); text-shadow: 0 0 5px var(--primary-theme-color); }
        .divine-kingdom-card { border: 2px solid var(--tier-7-color); background: radial-gradient(circle at top left, #333, #111); box-shadow: 0 0 15px rgba(var(--tier-7-color-rgb), 0.3); }
        .divine-kingdom-card .card-title { color: var(--tier-7-color); text-shadow: 0 0 5px rgba(var(--tier-7-color-rgb), 0.5); }
        .tab-container { margin-top: 1rem; }
        .tab-nav { display: flex; border-bottom: 2px solid var(--border-color); }
        .tab-button { flex: 1 1 auto; text-align: center; font-family: var(--font-secondary); font-size: 1rem; background: rgba(51, 51, 51, 0.4); border: none; padding: 0.625rem 0.5rem; cursor: pointer; border-bottom: 3px solid transparent; transition: all 0.2s ease; margin-bottom: -2px; position: relative; color: var(--text-muted-color); }
        .tab-button:hover { background-color: rgba(51, 51, 51, 0.5); color: var(--text-color); } .tab-button.active { border-bottom-color: var(--secondary-theme-color); font-weight: bold; color: var(--secondary-theme-color); background-color: rgba(51, 51, 51, 0.6); } .tab-button:active { background-color: rgba(51, 51, 51, 0.7); }
        .tab-content-container { padding: 1rem 5px; } 
        .tab-content { display: none; } .tab-content.active { display: block; animation: slideInUp 0.5s ease-out; }
        @keyframes slideInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes glow-pulse { 0%, 100% { transform: translate(-50%, -50%) scale(0.95); } 50% { transform: translate(-50%, -50%) scale(1.05); } }
        @keyframes release-shockwave-outer { from { transform: translate(-50%, -50%) scale(0.5); opacity: 0.7; } to { transform: translate(-50%, -50%) scale(2.5); opacity: 0; } }
        @keyframes release-shockwave-inner { from { transform: translate(-50%, -50%) scale(0); opacity: 0.8; } to { transform: translate(-50%, -50%) scale(1.5); opacity: 0; } }
        .char-name::before, .char-name::after { content: ''; position: absolute; top: 50%; left: 50%; width: 100%; padding-top: 100%; border-radius: 50%; border-style: solid; border-color: var(--secondary-theme-color); opacity: 0; pointer-events: none; transform: translate(-50%, -50%) scale(0); }
        .char-name.is-releasing::before { border-width: 4px; animation: release-shockwave-inner 0.5s ease-out; } .char-name.is-releasing::after { border-width: 2px; animation: release-shockwave-outer 0.7s ease-out; }
        @keyframes release-glow { from { box-shadow: 0 0 0 0px rgba(var(--primary-theme-color-rgb), 0.5); } to { box-shadow: 0 0 0 15px rgba(var(--primary-theme-color-rgb), 0); } }
        .attribute-item.is-releasing-glow .attribute-box, .tab-button.is-releasing-glow { animation: release-glow 0.5s ease-out; }
        @keyframes scan-pulse { from { background-position: -200% 0; } to { background-position: 200% 0; } }
        .vital-item::before { content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 2; background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.4) 50%, transparent 100%); background-size: 200% 100%; background-position: -200% 0; pointer-events: none; }
        .vital-item.is-active::before { animation: scan-pulse 0.7s ease-out; } .vital-item.is-active .vital-label, .vital-item.is-active .vital-value { color: #fff; }
        
        #save-to-lorebook-btn { position: absolute; top: 15px; right: 15px; padding: 8px 12px; background-color: #4A5568; color: white; border: none; border-radius: 5px; cursor: pointer; font-family: var(--font-secondary); font-size: 0.875rem; opacity: 0.8; transition: all 0.2s ease; z-index: 50; }
        #save-to-lorebook-btn:hover { opacity: 1; }
        
        /* --- MEDIA QUERIES & RESPONSIVE DESIGN START --- */
        @media (min-width: 768px) { 
            .sheet-body { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; } 
            .vitals-section, .tab-container { grid-column: 1 / -1; } 
            .core-info { grid-column: 1 / 2; display: flex; } 
            .attributes-section { grid-column: 2 / 3; display: flex; }
            .info-grid { grid-auto-rows: 1fr; } 
            .attributes-grid { grid-template-columns: repeat(2, 1fr); flex-grow: 1; } 
            .attributes-grid::before, .attributes-grid::after { display: block; left: 50%; } 
            .attributes-grid::before { top: 33.333%; }
            .attributes-grid::after { top: 66.666%; }
        }
        @media (max-width: 767px) { 
            body { padding: 20px 10px; }
            .card-wrapper::before, .card-wrapper::after { display: none; }
            .core-info, .attributes-section { display: flex; justify-content: center; } 
            .attributes-section, .vitals-section { margin-top: 15px; } 
            .info-grid, .attributes-grid { max-width: 500px; } 
            .info-grid { grid-template-columns: repeat(2, 1fr); } 
            .attributes-grid { grid-template-columns: repeat(3, 1fr); } 
            .attributes-grid::before, .attributes-grid::after { display: block; top: 50%; }
            
            .attributes-grid::before { left: calc(33.333% - 1.33px); } 
            .attributes-grid::after { left: calc(66.666% + 1.33px); }
        }
        @media (min-width: 481px) { 
            .attributes-grid::before, .attributes-grid::after { width: 28px; height: 28px; border-width: 4px; } 
        }
        @media (max-width: 480px) { 
            html { font-size: 14px; } 
            .character-sheet { box-shadow: none; border-width: 2px; }
            .sheet-header { border-bottom-width: 0; padding-top: 15px; }
            .sheet-body { display: block; padding: 15px; } .core-info, .attributes-section { display: block; } 
            .info-grid { grid-template-columns: 1fr; max-width: 100%; } .info-grid::before { display: none; } .info-grid .info-item { border-radius: 5px !important; } 
            .attributes-grid { max-width: 100%; grid-template-columns: repeat(2, 1fr); } 
            .attributes-grid::before, .attributes-grid::after { display: block; left: 50%; top: auto; } 
            .attributes-grid::before { top: 33.333%; }
            .attributes-grid::after { top: 66.666%; }
            .core-info-placeholder { display: none; } .tab-nav { flex-wrap: wrap; } .tab-button { flex-basis: 50%; } 
            #save-to-lorebook-btn { padding: 5px 8px; font-size: 1.2rem; top: 10px; right: 10px; width: auto; height: auto; background-color: rgba(74, 85, 104, 0.6); }
            .btn-text { display: none; }
        }
       @media (max-width: 360px) {
            /* 1. 基礎字體縮小至 10pt */
            html {
                font-size: 10pt;
            }

            /* 2. 縮減各容器體積與間距，以適應極窄螢幕 */
            body {
                padding: 10px 5px;
            }
            .sheet-header {
                padding: 10px 10px 5px;
            }
            .sheet-body {
                padding: 10px 5px;
            }
            .card {
                padding: 0.75rem; /* ~10px */
                margin-bottom: 0.5rem; /* ~7px */
            }
            .tab-content-container {
                padding: 0.75rem 0;
            }

            /* 3. 大幅降低標題與文本字體的差距 */
            .char-name {
                font-size: 2rem; /* 從 2.5rem 縮小 */
                letter-spacing: 1px;
                /* 簡化文字陰影以提高小尺寸下的清晰度 */
                text-shadow: 
                    1px 1px 0 var(--primary-theme-color),
                    -1px -1px 0 var(--primary-theme-color),
                    1px -1px 0 var(--primary-theme-color),
                    -1px 1px 0 var(--primary-theme-color),
                    0 0 3px var(--primary-theme-color);
            }
            .char-sub-info {
                gap: 0.75rem; /* 從 1.5rem 縮小 */
                margin-top: 0.5rem;
            }
            .subsection-title {
                font-size: 1.3rem;
                margin-top: 0.75rem;
                margin-bottom: 0.25rem;
                padding-left: 0.5rem;
            }
            .card-title {
                font-size: 1.2rem;
            }
            .attribute-total {
                font-size: 1.3rem;
            }
            .info-value, .vital-value {
                font-size: 1.1rem;
            }
            /* 確保標籤和次要文本不會過小 */
            .info-label, .card-subtitle, .card-tag {
                font-size: 0.9rem;
            }
            .tab-button {
                font-size: 0.9rem;
                padding: 0.5rem 0.25rem;
            }

            /* 4. 其他能幫助正常閱讀的設計 (佈局調整) */
            .vitals-grid {
                grid-template-columns: 1fr; /* 將 HP/MP/SP 垂直堆疊 */
                gap: 5px;
            }
            .attributes-grid {
                grid-template-columns: 1fr; /* 將屬性垂直堆疊 */
            }
            .attributes-grid::before, .attributes-grid::after {
                display: none; /* 在單欄佈局中隱藏不適用的裝飾線 */
            }

            /* 5. 優化右上角按鈕 */
            #save-to-lorebook-btn {
                top: 8px;
                right: 8px;
                padding: 4px 6px;
                font-size: 1rem; /* 從 1.2rem 縮小 */
            }
        }